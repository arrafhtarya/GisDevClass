<!doctype html>
<html lang="zh-Hant">
<head>
  <meta http-equiv="Pragma" content="no-cache" />
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.9.0/css/ol.css" type="text/css" />
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      margin: 10px;
    }
    .map {
      width: 100%;
      height: 480px;
      margin-bottom: 10px;
    }
    .ol-tooltip {
      position: relative;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 4px;
      color: white;
      padding: 4px 8px;
      opacity: 0.7;
      white-space: nowrap;
      font-size: 12px;
    }
    .ol-tooltip-measure {
      opacity: 1;
      font-weight: bold;
    }
    .ol-tooltip-static {
      background-color: #ffcc33;
      color: black;
      border: 1px solid white;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.9.0/build/ol.js"></script>
  <title>ä¸­å€ç”œé»æ¨è–¦åœ°åœ–</title>
</head>

<body>
<h2>ä¸­å€ç”œé»æ¨è–¦åœ°åœ–</h2>

<div id="map" class="map"></div>

<!-- åœ°åœ–æ§åˆ¶ -->
<form>
  <h4>ğŸ“ åœ°åœ–æ§åˆ¶</h4>
  <input type="button" value="èµ·å§‹ä½ç½®" onclick="GoInitView();" />
  <input type="button" value="CJSJ" onclick="PanToCJSJ();" />
  <input type="button" value="æ³•èŠ™å°¼" onclick="PanToFFN();" />
  <input type="button" value="æ³•å¸ƒç”œ" onclick="PanToFBT();" />
  <input type="button" value="å›æ†¶ç”œé»" onclick="PanToHYTD();" />
  <input type="button" value="AB" onclick="PanToAB();" />
  <input type="button" value="è’”åˆç”œé»" onclick="PanToSTSUTD();" />
</form>

<hr>

<!-- å¿«é€Ÿå®šä½ -->
<h4>ğŸ“Œ å¿«é€Ÿå®šä½</h4>
<select onchange="flyToLocation(this.value)">
  <option value="">è«‹é¸æ“‡åº—å®¶</option>
  <option value="CJSJ">CJSJ</option>
  <option value="FFN">æ³•èŠ™å°¼</option>
  <option value="FBT">æ³•å¸ƒç”œ</option>
  <option value="HYTD">å›æ†¶ç”œé»</option>
  <option value="AB">AB æ³•åœ‹äººçš„ç”œé»åº—</option>
  <option value="STSUTD">è’”åˆç”œé»</option>
</select>

<input type="checkbox" checked onchange="toggleMarkers(this.checked)"> é¡¯ç¤ºåœ°æ¨™

<hr>

<div id="mousePosition" style="padding:6px;background:#fff;border:1px solid #ccc;display:inline-block;">
  ç¶“ç·¯åº¦ï¼š
</div>

<script>
/* ---------- åœ°åœ–åˆå§‹åŒ– ---------- */
const initCenter = ol.proj.fromLonLat([120.6465, 24.1788]);
const view = new ol.View({ center: initCenter, zoom: 14 });

const map = new ol.Map({
  target: "map",
  layers: [new ol.layer.Tile({ source: new ol.source.OSM() })],
  view: view,
});

/* ---------- åœ°æ¨™ ---------- */
const locations = [
  { name: "CJSJ", coord: [120.6640, 24.1448] },
  { name: "æ³•èŠ™å°¼", coord: [120.6643, 24.1507] },
  { name: "æ³•å¸ƒç”œ", coord: [120.6524, 24.1599] },
  { name: "å›æ†¶ç”œé»", coord: [120.6766, 24.1641] },
  { name: "AB", coord: [120.6612, 24.1250] },
  { name: "è’”åˆç”œé»", coord: [120.6588, 24.1250] },
];

const markerSource = new ol.source.Vector();
locations.forEach(l => {
  markerSource.addFeature(new ol.Feature({
    geometry: new ol.geom.Point(ol.proj.fromLonLat(l.coord)),
    name: l.name
  }));
});

const markerLayer = new ol.layer.Vector({
  source: markerSource,
  style: f => new ol.style.Style({
    image: new ol.style.Circle({
      radius: 6,
      fill: new ol.style.Fill({ color: "#ffcc33" }),
      stroke: new ol.style.Stroke({ color: "#333", width: 1 })
    }),
    text: new ol.style.Text({
      text: f.get("name"),
      offsetY: -15,
      fill: new ol.style.Fill({ color: "#000" }),
      stroke: new ol.style.Stroke({ color: "#fff", width: 3 })
    })
  })
});
map.addLayer(markerLayer);

/* ---------- æ§åˆ¶åŠŸèƒ½ ---------- */
const CJSJ = ol.proj.fromLonLat([120.6640, 24.1448]);
const FFN = ol.proj.fromLonLat([120.6643, 24.1507]);
const FBT = ol.proj.fromLonLat([120.6524, 24.1599]);
const HYTD = ol.proj.fromLonLat([120.6766, 24.1641]);
const AB = ol.proj.fromLonLat([120.6612, 24.1250]);
const STSUTD = ol.proj.fromLonLat([120.6588, 24.1250]);

function GoInitView(){ view.animate({center:initCenter,duration:1200}); }
function PanToCJSJ(){ view.animate({center:CJSJ,duration:1200}); }
function PanToFFN(){ view.animate({center:FFN,duration:1200}); }
function PanToFBT(){ view.animate({center:FBT,duration:1200}); }
function PanToHYTD(){ view.animate({center:HYTD,duration:1200}); }
function PanToAB(){ view.animate({center:AB,duration:1200}); }
function PanToSTSUTD(){ view.animate({center:STSUTD,duration:1200}); }

function flyToLocation(name){
  const dict={CJSJ,FFN,FBT,HYTD,AB,STSUTD};
  if(dict[name]) view.animate({center:dict[name],zoom:16,duration:1500});
}

function toggleMarkers(show){
  markerLayer.setVisible(show);
}

/* ---------- æ»‘é¼ ç¶“ç·¯åº¦ ---------- */
map.addControl(new ol.control.MousePosition({
  projection:"EPSG:4326",
  coordinateFormat:c=>c[1].toFixed(6)+", "+c[0].toFixed(6),
  target:document.getElementById("mousePosition")
}));

/* ---------- å…¨è¢å¹• + æ¯”ä¾‹å°º ---------- */
map.addControl(new ol.control.FullScreen());
map.addControl(new ol.control.ScaleLine());

/* ---------- é›™æ“Šå°èˆª ---------- */
map.on("dblclick",evt=>{
  const c=ol.proj.toLonLat(evt.coordinate);
  window.open(`https://www.google.com/maps?q=${c[1]},${c[0]}`);
});
</script>

</body>
</html>

